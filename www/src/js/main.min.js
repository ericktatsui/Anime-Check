var app=angular.module("AnimeCheck",["ui.router"]),CONFIG={enableDebug:!1,apiUrl:"https://anilist.co/api/",debugUrl:"http://ericktatsui.com.br/anime-check/",currentYear:(new Date).getFullYear()},TEMP={animeList:null,mangaList:null,movieList:null};app.run(function(n,t){n.cutName=function(n){var t=n;return n&&n.length>=40&&(t=n.substr(0,40)+"..."),t};n.menuAction=function(n){AC.TouchMenu.close();t.go(n)}});app.config(function(n,t){t.otherwise("/splash");n.state("splash",{url:"/splash",templateUrl:"view/splash.html",controller:"SplashCtrl"}).state(".menu",{templateUrl:"view/menu.html",controller:"MenuCtrl"}).state("main",{url:"/main",templateUrl:"view/main.html"}).state("registration",{url:"/registration",templateUrl:"view/registration.html",controller:"RegistrationCtrl"}).state("home",{url:"/home",views:{"":{templateUrl:"view/home.html",controller:"HomeCtrl"},"animes@home":{templateUrl:"view/series.html",controller:"HomeTabAnimesCtrl"},"mangas@home":{templateUrl:"view/series.html",controller:"HomeTabMangasCtrl"}}}).state("all-my",{url:"/all-my",views:{"":{templateUrl:"view/all-my.html",controller:"MySeriesCtrl"},"animes@all-my":{templateUrl:"view/series.html",controller:"MySeriesTabAnimesCtrl"},"mangas@all-my":{templateUrl:"view/series.html",controller:"MySeriesTabMangasCtrl"}}}).state("category",{url:"/category/:name",views:{"":{templateUrl:"view/by-category.html",controller:"CategoryCtrl"},"animes@category":{templateUrl:"view/series.html",controller:"CategoryTabAnimesCtrl"},"mangas@category":{templateUrl:"view/series.html",controller:"CategoryTabMangasCtrl"}}}).state("categoryList",{url:"/category-list",templateUrl:"view/category-list.html",controller:"CategoryListCtrl"}).state("series",{url:"/series",templateUrl:"view/series.html",controller:"TabAnimesCtrl"}).state("serie",{url:"/serie/:type/:id",views:{"":{templateUrl:"view/serie.html",controller:"SerieCtrl"},"include@serie":{templateUrl:function(n){return"view/serie."+n.type+".html"},controllerProvider:function(n){return"Serie"+n.type.charAt(0).toUpperCase()+n.type.slice(1).toLowerCase()+"Ctrl"}}}}).state("list",{url:"/list/:id",views:{"":{templateUrl:"view/list.html",controller:"ListCtrl"},"series@list":{templateUrl:"view/series.html",controller:"ListSeriesCtrl"}}}).state("lists",{url:"/lists",templateUrl:"view/lists.html",controller:"ListsCtrl"}).state("search",{url:"/search/:term?",views:{"":{templateUrl:"view/search.html",controller:"SearchCtrl"},"anime-search@search":{templateUrl:"view/series.html",controller:"SearchTabAnimesCtrl"},"manga-search@search":{templateUrl:"view/series.html",controller:"SearchTabMangasCtrl"}}})});app.service("$acRequest",function(n){this.get=function(t,i,r){var u={method:"GET",url:t};n(u).success(i).error(r)};this.post=function(t,i,r,u){var f={method:"POST",url:t,data:i};n(f).success(r).error(u)};this.custom=function(t,i,r){n(t).success(i).error(r)}});app.service("$acApi",function(n,t,i){this.getTokenApi=function(n){var i=null;localStorage.accessToken&&(i=JSON.parse(localStorage.accessToken));!i||i.date<(new Date).getTime()?t.post("https://anilist.co/api/auth/access_token",{grant_type:"client_credentials",client_id:"tatsui-rvts7",client_secret:"b9wByu0EKevXxKIecxnaenn"},function(t){localStorage.accessToken=JSON.stringify({token:t.access_token,date:(new Date).setSeconds((new Date).getSeconds()+3600)});n(t.access_token)},function(n){console.error(n)}):n(i.token)};this.getToken=function(n){CONFIG.enableDebug?n():this.getTokenApi(n)};this.fromId=function(n,r,u,f){this.getToken(function(e){var o;CONFIG.enableDebug?(u=u?"page":"id",o=CONFIG.debugUrl+u+"/"+n+"/"+r):(u=u?"/page":"",o=CONFIG.apiUrl+n+"/"+r+u+"/?access_token="+e);i.getAnime(r,function(n){n.length==0?t.get(o,function(n){f(n)},function(n){console.error(n);f(n)}):(n[0].synonyms=n[0].synonyms.split(", "),n[0].genres=n[0].genres.split(", "),f(n[0]))})})};this.search=function(n,i,r){this.getToken(function(u){var f="";f=CONFIG.enableDebug?CONFIG.debugUrl+"search/"+n+"/"+i:CONFIG.apiUrl+n+"/search/"+i+"/?access_token="+u;t.get(f,function(n){typeof n!="object"&&(n=[]);r(n)},function(n){console.error(n);r(n)})})};this.list=function(n,i,r){this.getToken(function(u){var f="",e="";for(var o in i)f+="&"+o+"="+i[o];e=CONFIG.enableDebug?CONFIG.debugUrl+"list/"+n+"/?"+f:CONFIG.apiUrl+"browse/"+n+"/?"+f+"&access_token="+u;t.get(e,function(n){r(n)},function(n,t){console.error(n);console.error(t);r(n)})})}});app.service("$Cache",function(n){this.saveAnime=function(n,t,i){this.getAnime(n.id,function(r){r.length==0?AC.Tools.saveFile(n.image_url_lge,function(i){var r={CACHE_ID:n.id,CACHE_TYPE:n.type.toLowerCase(),CACHE_TITLE:n.title_romaji,CACHE_TITLE_JP:n.title_japanese,CACHE_IMG:i,CACHE_SCORE:n.average_score,CACHE_STATUS:n.airing_status||n.publishing_status,CACHE_DTEND:n.end_date,CACHE_DTSTART:n.start_date,CACHE_YOUTUBEID:n.youtube_id,CACHE_GENRES:n.genres.join(", "),CACHE_DURATION:n.duration,CACHE_EPISODES:n.total_episodes,CACHE_CHAPTERS:n.total_chapters,CACHE_VOLUMES:n.total_volumes,CACHE_SYNONYMS:n.synonyms.join(", "),CACHE_DTEDITION:moment().format()};AC.Db.insert("AC_SERIE_CACHE",r,t)},function(){typeof i=="function"&&i()}):typeof t=="function"&&t()})};this.getAnime=function(n,t){var i="SELECT";i+=' CACHE_ID AS "id", CACHE_TYPE AS "type", CACHE_TITLE AS "title_romaji", CACHE_TITLE_JP AS "title_japanese", CACHE_IMG AS "image_url_lge", CACHE_SCORE AS "average_score", CACHE_STATUS AS "airing_status", CACHE_DTEND AS "end_date", CACHE_DTSTART AS "start_date", CACHE_YOUTUBEID AS "youtube_id", CACHE_GENRES AS "genres", CACHE_DURATION AS "duration", CACHE_EPISODES AS "total_episodes", CACHE_CHAPTERS AS "total_chapters", CACHE_VOLUMES AS "total_volumes", CACHE_SYNONYMS AS "synonyms"';i+=" FROM AC_SERIE_CACHE";i+=" WHERE CACHE_ID = "+n;AC.Db.query(i,function(n){t(n)})};this.refreshMenu=function(t){var i='SELECT l.*, count(s.sl_serie_id) as "count"';i+=" FROM AC_LIST l ";i+=" LEFT JOIN AC_SERIE_LIST s ON s.SL_LIST_ID = l.LIST_ID";i+=" GROUP BY LIST_ID";i+=" ORDER BY LIST_ID";AC.Db.query(i,function(i){n.menuLists=i;n.$apply();typeof t=="function"&&t(i)})}});app.controller("SplashCtrl",function(n,t){document.addEventListener("dbReady",function(){AC.Db.query("SELECT * FROM AC_USER",function(n){n.length>0?(localStorage.setItem("user",JSON.stringify(n[0])),t.go("all-my")):t.go("registration")})});AC.initialize(null,null,!0).initDebug();AC.Db.initialize()});app.controller("RegistrationCtrl",function(n,t){n.saveUser=function(){var i="INSERT INTO AC_USER",r,u;i+=" (USER_NAME, USER_EMAIL, USER_PASSWORD, USER_DTEDITION)";i+=" VALUES (";i+=" '"+n.name+"',";i+=" '"+n.email+"',";i+=" '"+n.password+"',";i+=" '"+moment().format()+"'";i+=" )";r=!0;u="";(n.password==undefined||n.password!==n.rePassword||n.password=="")&&(r=!1,u+="As senhas não conferem.");(n.email==undefined||n.email.indexOf("@")==1)&&(r=!1,u+="\nE-mail inválido.");r?AC.Db.query(i,function(){AC.Tools.toast("Salvo com sucesso.",AC.Models.toastTypes.SHORT_BOTTOM);t.go("all-my")}):AC.Tools.toast(u,AC.Models.toastTypes.SHORT_BOTTOM)}});app.controller("HomeCtrl",function(n,t){AC.initialize(n,function(){TEMP.animeList?AC.loading.hide():AC.loading.show();AC.SlideTabs=TouchTabsLA({container:document.getElementById("ttla-container"),content:document.getElementById("ttla-content"),tabs:document.getElementById("tabs"),header:document.getElementById("header"),resize:!0,onTabChange:function(){}})});n.openAnime=function(n,i){var r="anime";n=n.toLowerCase();AC.Models.mangaTypes.indexOf(n)!=-1&&(r="manga");t.go("serie",{type:r,id:i})}});app.controller("HomeTabAnimesCtrl",function(n,t,i){n.type="anime";TEMP.animeList==null?i.list("anime",{year:CONFIG.currentYear},function(t){n.list=t;n.type="anime";TEMP.animeList=t;AC.loading.hide()}):(n.list=TEMP.animeList,AC.loading.hide())});app.controller("HomeTabMangasCtrl",function(n,t,i){n.type="manga";document.getElementById("tab2").addEventListener("tabFocused",function(){AC.loading.show();TEMP.mangaList==null?i.list("manga",{year:CONFIG.currentYear},function(t){n.list=t;n.$applyAsync();TEMP.mangaList=t;AC.loading.hide()}):(n.list=TEMP.mangaList,n.$applyAsync(),AC.loading.hide())})});app.controller("HomeTabMoviesCtrl",function(n,t,i){n.type="anime";document.getElementById("tab3").addEventListener("tabFocused",function(){AC.loading.show();TEMP.movieList==null?i.list("anime",{year:CONFIG.currentYear,type:"movie"},function(t){n.list=t;n.$applyAsync();TEMP.movieList=t;AC.loading.hide()}):(n.list=TEMP.movieList,n.$applyAsync(),AC.loading.hide())})});app.controller("SearchCtrl",function(n,t,i,r){var f,u,e;n.openAnime=function(n,t){var i="anime";n=n.toLowerCase();AC.Models.mangaTypes.indexOf(n)!=-1&&(i="manga");r.go("serie",{type:i,id:t})};e=function(){AC.loading.show()};AC.initialize(n,function(){var t=document.getElementById("searchField"),i=document.getElementById("searchText"),l=document.getElementById("header"),a=l.getElementsByClassName("icon-btn"),o=document.getElementById("searchClose"),s=document.getElementById("searchButton"),h=document.getElementById("searchBack"),c;t=document.getElementById("searchField");AC.SlideTabs=TouchTabsLA({container:document.getElementById("ttla-container"),content:document.getElementById("ttla-content"),tabs:document.getElementById("tabs"),header:document.getElementById("header"),resize:!0,onTabChange:function(){}});c=function(){t.style.width=window.innerWidth-70+"px"};c();window.addEventListener("resize",c);f=function(){o.style.display="block";h.style.display="none";i.style.display="none";t.style.display="block";s.style.display="none";t.value="";n.$applyAsync();t.focus()};u=function(){o.style.display="none";h.style.display="block";i.style.display="block";t.style.display="none";s.style.display="block";t.value==""&&(t.value="Buscar",n.$applyAsync())};r.params.term?(u(),n.searchQuery=r.params.term,n.$applyAsync(),e()):t.focus();n.searchSubmit=function(){r.go("search",{term:t.value});e();u()};i.addEventListener("click",f);s.addEventListener("click",f);o.addEventListener("click",u);h.addEventListener("click",function(){AC.loading.hide()})})});app.controller("SearchTabAnimesCtrl",function(n,t,i){i.term!=""&&i.term!=undefined&&i.term!=null?t.search("anime",i.term,function(t){n.list=t;AC.loading.hide();setTimeout(function(){AC.TouchTabsLA.setContainerSize()},500)}):n.list=[]});app.controller("SearchTabMangasCtrl",function(n,t,i,r){(r.term==""||r.term==undefined||r.term==null)&&(n.lastMangaSearch=[]);document.getElementById("tab2").addEventListener("tabFocused",function(){n.lastMangaSearch==undefined||n.lastMangaSearch==null||n.lastMangaSearch==""?(AC.loading.show(),i.search("manga",r.term,function(t){n.list=t;n.lastMangaSearch=t;AC.loading.hide();setTimeout(function(){AC.TouchTabsLA.setContainerSize()},500)})):(n.list=n.lastMangaSearch,setTimeout(function(){AC.TouchTabsLA.setContainerSize()},500));n.$apply()})});app.controller("SerieCtrl",function(n,t,i,r,u){var f,e,o,s,h;n.lists=[];AC.loading.show();AC.initialize(n,function(){f=document.querySelector("#header.header-serie");e=document.getElementById("serie-content");o=document.getElementById("serie-content-num");h()});n.serie={};n.selectList=function(){AC.Db.query("SELECT * FROM AC_SERIE_LIST WHERE SL_SERIE_ID = "+r.id,function(n){n.length==0?AC.Dialog.show("choose-list"):AC.Tools.toast("Anime já está em uma lista.",AC.Models.toastTypes.SHORT_BOTTOM)})};h=function(){s=document.getElementById("dialog-list-cancel");s.addEventListener("click",function(){AC.Dialog.hide("choose-list")});n.lists=t.menuLists};window.lockAddList=!1;n.addToList=function(n){window.lockAddList||(window.lockAddList=!0,AC.Db.query("INSERT INTO AC_SERIE_LIST (SL_SERIE_ID, SL_LIST_ID, SL_TYPE, SL_DTEDITION) VALUES ("+r.id+", "+n.LIST_ID+", '"+r.type+"', '"+moment().format()+"')",function(){AC.Dialog.hide("choose-list");t.currentList=n;t.inList=!0;t.$apply();f.style.height=window.innerHeight-100+"px";e.style.top=window.innerHeight-100+"px";o.style.height="101px";AC.Tools.toast("Adicionado a lista "+n.LIST_NAME,AC.Models.toastTypes.SHORT_BOTTOM);u.saveAnime(t.showing,function(){setTimeout(function(){window.lockAddList=!1},500)});u.refreshMenu()}))};n.closeDialog=function(n){AC.Dialog.hide(n)};n.dialogMoveList=function(){AC.Dialog.show("move-list")};n.moveToList=function(i){AC.Db.update("AC_SERIE_LIST","SL_SERIE_ID = "+r.id,{SL_LIST_ID:i.LIST_ID},function(){AC.Dialog.hide("move-list");AC.Tools.toast("Movido para a lista "+i.LIST_NAME,AC.Models.toastTypes.SHORT_BOTTOM);t.currentList=i;n.$apply();u.refreshMenu()})};n.removeFromList=function(){AC.Db.remove("AC_SERIE_LIST","SL_SERIE_ID = "+r.id,function(){AC.Db.remove("AC_SERIE","SERIE_EXT_ID = "+r.id,function(){t.inList=!1;f.style.height=window.innerHeight+"px";e.style.top=window.innerHeight+"px";o.style.height="0";n.$apply();u.refreshMenu();AC.Tools.toast("Removido da lista.",AC.Models.toastTypes.SHORT_BOTTOM)})})};n.createNewList=function(t){AC.Dialog.show("create-list");AC.Dialog.hide(t);n.lastDialog=t};n.cancelCreate=function(){AC.Dialog.hide("create-list");AC.Dialog.show(n.lastDialog)};n.saveCreate=function(){AC.Db.insert("AC_LIST",{LIST_NAME:n.newListName,LIST_DTEDITION:moment().format()},function(){u.refreshMenu(function(i){n.lists=i;t.inList?n.moveToList(i[i.length-1]):n.addToList(i[i.length-1]);n.$apply();AC.Dialog.hide("create-list")})})}});app.controller("SerieAnimeCtrl",function(n,t,i,r){var u,f,e,o,s,h,c,l,p,a="anime",v,y;n.currentEpisode="--";n.currentSeason="--";n.updateSeason=1;n.updateEpisode=0;AC.initialize(n,function(){u=document.querySelector("#header.header-serie");f=document.getElementById("serie-content");e=document.getElementById("serie-content-num");p=document.getElementById("fab");var i="SELECT * FROM AC_SERIE_LIST ";i+=" LEFT JOIN AC_SERIE ON SERIE_EXT_ID = SL_SERIE_ID";i+=" LEFT JOIN AC_LIST ON LIST_ID = SL_LIST_ID";i+=" WHERE SL_SERIE_ID = "+r.id;i+=" ORDER BY SERIE_DTEDITION DESC LIMIT 1";AC.Db.query(i,function(i){i.length>0?(t.currentList={LIST_ID:i[0].LIST_ID,LIST_NAME:i[0].LIST_NAME,LIST_DTEDITION:i[0].LIST_DTEDITION},i[0].SERIE_EXT_ID!=null?(n.currentSeason=i[0].SERIE_SEASON,n.currentEpisode=i[0].SERIE_NUM,n.updateSeason=i[0].SERIE_SEASON,n.updateEpisode=i[0].SERIE_NUM):(n.currentSeason=1,n.currentEpisode=0),t.inList=!0,u.style.height=window.innerHeight-100+"px",f.style.top=window.innerHeight-100+"px",setTimeout(function(){e.style.height="101px"},1e3)):(n.currentSeason=1,n.currentEpisode=0,t.inList=!1,u.style.height=window.innerHeight+"px",f.style.top=window.innerHeight+"px");n.$apply()});v();y()});i.fromId("anime",r.id,!1,function(i){AC.loading.hide();i&&(n.serie.title=i.title_romaji,n.serie.titleJp=i.title_japanese,n.serie.img=i.image_url_lge,n.serie.score=i.average_score,n.serie.status=AC.Models.translation.status[i.airing_status.toLowerCase()],n.serie.genres=AC.Tools.translateList(AC.Models.translation.genres,i.genres),n.serie.episodes=AC.Tools.toInt(i.total_episodes),n.serie.duration=AC.Tools.toInt(i.duration),n.serie.synonyms=i.synonyms.join(", "),u.style.backgroundImage="url("+i.image_url_lge+")",t.showing=i,n.$apply());a=i.type});v=function(){o=document.getElementById("season-button");o.addEventListener("click",function(){n.updateSeason=n.currentSeason;n.$apply();AC.Dialog.show("change-season")});s=document.getElementById("dialog-season-cancel");s.addEventListener("click",function(){AC.Dialog.hide("change-season")});h=document.getElementById("dialog-season-save");h.addEventListener("click",function(){AC.Db.query("SELECT * FROM AC_SERIE WHERE SERIE_EXT_ID = "+r.id+" AND SERIE_SEASON = "+n.updateSeason+" LIMIT 1",function(t){t.length==0?AC.Db.query("INSERT INTO AC_SERIE (SERIE_EXT_ID, SERIE_TYPE, SERIE_SEASON, SERIE_NUM, SERIE_DTEDITION) VALUES ("+r.id+", '"+a+"', "+n.updateSeason+", 0, '"+moment().format()+"')",function(){n.currentSeason=n.updateSeason;n.currentEpisode=0;n.updateSeason=n.updateSeason;n.updateEpisode=0;n.$apply()}):AC.Db.update("AC_SERIE","SERIE_EXT_ID = "+r.id+" AND SERIE_SEASON = "+n.updateSeason,{SERIE_DTEDITION:moment().format()},function(){n.currentSeason=t[0].SERIE_SEASON;n.currentEpisode=t[0].SERIE_NUM;n.updateSeason=t[0].SERIE_SEASON;n.updateEpisode=t[0].SERIE_NUM;n.$apply()})});AC.Dialog.hide("change-season")})};y=function(){changeEpisodeButton=document.getElementById("episode-button");changeEpisodeButton.addEventListener("click",function(){n.updateEpisode=n.currentEpisode;n.$apply();AC.Dialog.show("change-episode")});c=document.getElementById("dialog-episode-cancel");c.addEventListener("click",function(){AC.Dialog.hide("change-episode")});l=document.getElementById("dialog-episode-save");l.addEventListener("click",function(){AC.Db.query("SELECT * FROM AC_SERIE WHERE SERIE_EXT_ID = "+r.id+" AND SERIE_SEASON = "+n.currentSeason+" LIMIT 1",function(t){t.length>0?AC.Db.query("UPDATE AC_SERIE SET SERIE_NUM = "+n.updateEpisode+", SERIE_DTEDITION = '"+moment().format()+"' WHERE SERIE_SEASON = "+t[0].SERIE_SEASON,function(){n.currentEpisode=n.updateEpisode;n.$apply()}):AC.Db.query("INSERT INTO AC_SERIE (SERIE_EXT_ID, SERIE_TYPE, SERIE_SEASON, SERIE_NUM, SERIE_DTEDITION) VALUES ("+r.id+", 'manga', "+n.updateSeason+", "+n.updateEpisode+", '"+moment().format()+"')",function(){n.currentEpisode=n.updateEpisode;n.$apply()})});AC.Dialog.hide("change-episode")})};n.numberLess=function(t){n[t]>1&&n[t]--};n.numberPlus=function(t){n[t]++}});app.controller("SerieMangaCtrl",function(n,t,i,r){var u,f,e,o,s,h,c="manga",l;i.fromId("manga",r.id,!1,function(i){AC.loading.hide();i&&(n.serie.title=i.title_romaji,n.serie.titleJp=i.title_japanese,n.serie.img=i.image_url_lge,n.serie.score=i.average_score,n.serie.status=AC.Models.translation.status[(i.publishing_status||i.airing_status).toLowerCase()],n.serie.genres=AC.Tools.translateList(AC.Models.translation.genres,i.genres),n.serie.chapters=AC.Tools.toInt(i.total_chapters),n.serie.volumes=AC.Tools.toInt(i.total_volumes),n.serie.synonyms=i.synonyms.join(", "),u.style.backgroundImage="url("+i.image_url_lge+")",t.showing=i,c=i.type,n.$apply())});n.currentChapter="--";l=function(){o=document.getElementById("chapter-button");o.addEventListener("click",function(){n.updateSeason=n.currentChapter;n.$apply();AC.Dialog.show("change-chapter")});h=document.getElementById("dialog-chapter-cancel");h.addEventListener("click",function(){AC.Dialog.hide("change-chapter")});s=document.getElementById("dialog-chapter-save");s.addEventListener("click",function(){AC.Db.query("SELECT * FROM AC_SERIE WHERE SERIE_EXT_ID = "+r.id+" LIMIT 1",function(t){t.length>0?AC.Db.query("UPDATE AC_SERIE SET SERIE_NUM = "+n.updateChapter+", SERIE_DTEDITION = '"+moment().format()+"' WHERE SERIE_EXT_ID = "+r.id,function(){n.currentChapter=n.updateChapter;n.$apply()}):AC.Db.query("INSERT INTO AC_SERIE (SERIE_EXT_ID, SERIE_TYPE, SERIE_NUM, SERIE_DTEDITION) VALUES ("+r.id+", '"+c+"', "+n.updateChapter+", '"+moment().format()+"')",function(){n.currentChapter=n.updateChapter;n.updateChapter=n.updateChapter;n.$apply()})});AC.Dialog.hide("change-chapter")})};AC.initialize(n,function(){u=document.querySelector("#header.header-serie");f=document.getElementById("serie-content");e=document.getElementById("serie-content-num");var i="SELECT * FROM AC_SERIE_LIST ";i+=" LEFT JOIN AC_SERIE ON SERIE_EXT_ID = SL_SERIE_ID";i+=" LEFT JOIN AC_LIST ON LIST_ID = SL_LIST_ID";i+=" WHERE SL_SERIE_ID = "+r.id;i+=" ORDER BY SERIE_DTEDITION DESC LIMIT 1";AC.Db.query(i,function(i){i.length>0?(t.currentList={LIST_ID:i[0].LIST_ID,LIST_NAME:i[0].LIST_NAME,LIST_DTEDITION:i[0].LIST_DTEDITION},i[0].SERIE_EXT_ID!=null?(n.currentChapter=i[0].SERIE_NUM,n.updateChapter=i[0].SERIE_NUM):(n.currentChapter=1,n.updateChapter=1),t.inList=!0,u.style.height=window.innerHeight-100+"px",f.style.top=window.innerHeight-100+"px",setTimeout(function(){e.style.height="101px"},1e3)):(u.style.height=window.innerHeight+"px",f.style.top=window.innerHeight+"px",n.currentChapter=1,n.updateChapter=1,t.inList=!1);n.$apply();t.$apply()});l()});n.numberLess=function(t){n[t]>1&&n[t]--};n.numberPlus=function(t){n[t]++}});app.controller("GenreListCtrl",function(n,t){n.go=function(n,i){touchMenu.close();t.path("/category/"+n+"/"+i)}});app.controller("CategoryCtrl",function(n,t,i){n.category=i.title;t.list("list",{year:2015,genres:i.name},function(t){n.list=t})});app.controller("MenuCtrl",function(n,t,i,r){document.addEventListener("dbReady",function(){r.refreshMenu()});n.openList=function(n){i.go("list",{id:n});AC.TouchMenu.close()}});app.controller("ListCtrl",function(n,t,i,r,u){AC.loading.show();var f="SELECT *";f+=" FROM AC_LIST";f+=" WHERE LIST_ID = "+r.id;AC.Db.query(f,function(t){n.listName=t[0].LIST_NAME});n.openAnime=function(n,t){var r="anime";n=n.toLowerCase();AC.Models.mangaTypes.indexOf(n)!=-1&&(r="manga");i.go("serie",{type:r,id:t})};AC.initialize(n);n.delete=function(){AC.Dialog.show("delete-list")};n.deleteList=function(){AC.loading.show();AC.Db.delete("AC_LIST","LIST_ID = "+r.id,function(){AC.Db.delete("AC_SERIE_LIST","SL_LIST_ID = "+r.id,function(){u.refreshMenu(function(){AC.Tools.toast("Lista excluída com sucesso.",AC.Models.toastTypes.SHORT_BOTTOM);AC.loading.hide();i.go("all-my");n.$apply()})})})};n.closeDialog=function(n){AC.Dialog.hide(n)};n.edit=function(){AC.Dialog.show("change-name")};n.saveName=function(){AC.Db.update("AC_LIST","LIST_ID = "+r.id,{LIST_NAME:n.newName},function(){AC.Dialog.hide("change-name");n.listName=n.newName;u.refreshMenu()})}});app.controller("ListSeriesCtrl",function(n,t,i){var r="SELECT DISTINCT SL_SERIE_ID, ";r+='CACHE_ID AS "id", CACHE_TYPE AS "type", CACHE_TITLE AS "title_romaji", CACHE_TITLE_JP AS "title_japanese", CACHE_IMG AS "image_url_lge", CACHE_SCORE AS "average_score", CACHE_STATUS AS "airing_status", CACHE_DTEND AS "end_date", CACHE_DTSTART AS "start_date", CACHE_YOUTUBEID AS "youtube_id", CACHE_GENRES AS "genres", CACHE_DURATION AS "duration", CACHE_EPISODES AS "total_episodes", CACHE_CHAPTERS AS "total_chapters", CACHE_VOLUMES AS "total_volumes", CACHE_SYNONYMS AS "synonyms"';r+=" FROM AC_SERIE_LIST";r+=" INNER JOIN AC_SERIE_CACHE ON CACHE_ID = SL_SERIE_ID";r+=" WHERE SL_LIST_ID = "+i.id;AC.Db.query(r,function(t){n.list=t;n.$apply();AC.loading.hide()})});app.controller("MySeriesCtrl",function(n,t,i){AC.loading.show();AC.Db.query("SELECT * FROM AC_USER",function(i){t.userInfos=i[0];n.$apply()});document.addEventListener("backbutton",function(){navigator.app.exitApp()},!1);AC.initialize(n,function(){AC.SlideTabs=TouchTabsLA({container:document.getElementById("ttla-container"),content:document.getElementById("ttla-content"),tabs:document.getElementById("tabs"),header:document.getElementById("header"),resize:!0,onTabChange:function(){}});document.getElementsByClassName("menu-btn")[0].addEventListener("touchend",function(){AC.TouchMenu.open()})});n.openAnime=function(n,t){var r="anime";n=n.toLowerCase();AC.Models.mangaTypes.indexOf(n)!=-1&&(r="manga");i.go("serie",{type:r,id:t})}});app.controller("MySeriesTabAnimesCtrl",function(n){var t="SELECT DISTINCT SL_SERIE_ID, ",r,u,i;for(t+=' CACHE_ID AS "id", CACHE_TYPE AS "type", CACHE_TITLE AS "title_romaji", CACHE_IMG AS "image_url_lge"',t+=" FROM AC_SERIE_LIST",t+=" INNER JOIN AC_SERIE_CACHE ON CACHE_ID = SL_SERIE_ID",r=AC.Models.animeTypes,u=[],i=0;i<r.length;i++)u.push("CACHE_TYPE = '"+r[i]+"'");t+=" WHERE "+u.join(" OR ");AC.Db.query(t,function(t){n.list=t;n.$apply();AC.loading.hide()})});app.controller("MySeriesTabMangasCtrl",function(n){var t="SELECT DISTINCT SL_SERIE_ID, ",r,u,i;for(t+=' CACHE_ID AS "id", CACHE_TYPE AS "type", CACHE_TITLE AS "title_romaji", CACHE_IMG AS "image_url_lge"',t+=" FROM AC_SERIE_LIST",t+=" INNER JOIN AC_SERIE_CACHE ON CACHE_ID = SL_SERIE_ID",r=AC.Models.mangaTypes,u=[],i=0;i<r.length;i++)u.push("CACHE_TYPE = '"+r[i]+"'");t+=" WHERE "+u.join(" OR ");AC.Db.query(t,function(t){n.list=t;n.$apply();AC.loading.hide()})});app.controller("CategoryCtrl",function(n,t){AC.initialize(n,function(){AC.SlideTabs=TouchTabsLA({container:document.getElementById("ttla-container"),content:document.getElementById("ttla-content"),tabs:document.getElementById("tabs"),header:document.getElementById("header"),resize:!0,onTabChange:function(){}})});n.categoryName=AC.Models.translation.genres[t.params.name.toLowerCase().replace(/( )/g,"_")];n.openAnime=function(n,i){var r="anime";n=n.toLowerCase();AC.Models.mangaTypes.indexOf(n)!=-1&&(r="manga");t.go("serie",{type:r,id:i})}});app.controller("CategoryTabAnimesCtrl",function(n,t,i,r){AC.loading.show();i.list("anime",{genres:r.name,year:moment().format("YYYY")},function(t){n.list=t;TEMP.animeList=t;AC.loading.hide()})});app.controller("CategoryTabMangasCtrl",function(n,t,i,r){document.getElementById("tab2").addEventListener("tabFocused",function(){AC.loading.show();n.temp==undefined||n.temp==null||n.temp==""?i.list("manga",{genres:r.name,year:moment().format("YYYY")},function(t){n.list=t;n.temp=t;n.$apply();AC.loading.hide()}):(n.list=n.temp,n.$apply(),AC.loading.hide())})});app.controller("CategoryListCtrl",function(n){AC.initialize(n,function(){});n.categories=AC.Models.translation.genres});app.controller("ListsCtrl",function(n){AC.initialize(n,function(){});n.lists=$rootScope.menuLists});app.directive("-onhover",function(){return{restrict:"C",link:function(n,t){t.on("touchstart",function(){this.className=this.className+" -active"});t.on("touchend",function(){this.className=this.className.replace(" -active")})}}});app.directive("ngPreload",function(){return{restrict:"A",scope:{ngPreload:"="},link:function(n,t){if(n.ngPreload!=undefined&&n.ngPreload!=""){var i=new Image;i.onload=function(){t[0].style.backgroundImage="url("+this.src+")"};i.src=n.ngPreload}}}});
//# sourceMappingURL=main.min.js.map
